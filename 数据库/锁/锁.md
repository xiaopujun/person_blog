![](D:\study\person_blog\数据库\锁\MySQL锁机制.png)

# 前言

锁机制是为了解决共享资源被并发访问时出现的问题

# 锁分类

## 按操作范围

- 全局锁
- 页级锁
- 表级锁
    - 表锁：一次性锁定整个表。MyISAM默认就是表锁。表锁开销小，加锁快，无死锁。但锁范围大，容易锁冲突，并发度低
    - 元数据锁
    - 意向锁
    - 自增锁
- 行级锁
    - 行锁：一次性对一行数据加锁。InnoDB默认就是行锁。行锁开销大，加锁慢，容易死锁。但锁范围小，并发度高
    - 间隙锁
    - 临建锁

## 按操作类型

- 读锁（共享锁）：当数据被读锁锁定时，其他事务可以读取该数据，但不能修改该数据
- 写锁（排他锁）：当数据被写锁锁定时，其他事务不能读取该数据，也不能修改该数据

# 表锁示例

```sql
# 给表加读锁
lock tables table_name read;
# 给表加写锁
lock tables table_name write;
# 解锁
unlock tables;
# 查看加锁的表
show open tables;
```

设现在有两个MySQL会话：

> 当会话1对表A加读锁后

- 会话1可以继续读取表A的数据，但是无法修改表A的数据
- 会话2可以读取表A的数据，修改表A的数据会被阻塞，直到会话1释放锁

> 当会话1对表A加写锁后

- 会话1可以继续读取表A的数据，也可以修改表A的数据
- 会话2无法读取表A的数据，也无法修改表A的数据，会被阻塞，直到会话1释放锁




